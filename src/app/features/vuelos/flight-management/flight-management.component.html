<div class="flex h-full w-full flex-col items-center p-4 sm:p-6 lg:p-8">

  <!-- Título -->
  <div class="flex w-full max-w-7xl flex-col gap-6">

    <div class="flex flex-wrap items-center justify-between gap-4">
      <div class="flex flex-col gap-1">
        <h1 class="text-3xl font-black tracking-tight text-slate-900">
          Panel de Operaciones de Vuelo
        </h1>
        <p class="text-slate-500">Crea, edita y gestiona todos los vuelos programados.</p>
      </div>

      <!-- Botón Nuevo Vuelo -->
      <button
        [routerLink]="['/dashboard/vuelos/crear']"
        class="flex h-10 items-center justify-center gap-2 whitespace-nowrap rounded-lg
         bg-blue-600 px-4 text-sm font-bold text-white shadow-sm
         transition-colors hover:bg-blue-700">
        <svg xmlns="http://www.w3.org/2000/svg" class="size-5" fill="none"
             viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
        </svg>
        <span>Nuevo Vuelo</span>
      </button>
    </div>

    <!-- Buscador + Filtros -->
    <div class="flex flex-col gap-4 rounded-xl border border-slate-200 bg-white p-4">

      <div class="flex flex-col gap-4 md:flex-row md:items-center">

        <!-- Buscador -->
        <div class="flex-grow">
          <input type="text"
                 class="form-input h-10 w-full rounded-lg border-slate-300 bg-background-light pl-3 text-slate-900 placeholder:text-slate-400 focus:border-primary focus:ring-primary"
                 placeholder="Buscar por nº de vuelo, origen o destino..."
                 [(ngModel)]="filtroTexto"
                 (input)="aplicarFiltros()">
        </div>

        <!-- Filtros -->
        <div class="flex flex-wrap items-center gap-2">

          <!-- Fecha -->
          <input type="date"
                 class="h-10 rounded-lg border border-slate-300 px-3 text-sm text-slate-700"
                 [(ngModel)]="filtroFecha"
                 (change)="aplicarFiltros()">

          <!-- Estado -->
          <select class="h-10 rounded-lg border border-slate-300 px-3 text-sm text-slate-700"
                  [(ngModel)]="filtroEstado"
                  (change)="aplicarFiltros()">
            <option value="">Todos los estados</option>
            <option *ngFor="let estado of estados" [value]="estado">{{estado}}</option>
          </select>

        </div>

      </div>

      <!-- Tabla -->
      <div class="w-full overflow-x-auto">

        <!-- CARGANDO -->
        <div *ngIf="cargando" class="p-6 text-center text-slate-500">
          Cargando vuelos...
        </div>

        <!-- SIN VUELOS -->
        <div *ngIf="!cargando && vuelosFiltrados.length === 0" class="p-6 text-center text-slate-500">
          No hay vuelos registrados.
        </div>

        <!-- TABLA -->
        <table *ngIf="!cargando && vuelosFiltrados.length > 0"
               class="w-full min-w-[1000px] text-left">

          <thead>
          <tr class="border-b border-slate-200">
            <th class="px-4 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500">ID Vuelo</th>
            <th class="px-4 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500">Ruta</th>
            <th class="px-4 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500">Fecha/Hora Salida</th>
            <th class="px-4 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500">Avión</th>
            <th class="px-4 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500">Piloto</th>
            <th class="px-4 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500">Estado</th>
            <th class="px-4 py-3 text-xs font-semibold uppercase tracking-wider text-slate-500 text-right">Acciones</th>
          </tr>
          </thead>

          <tbody class="divide-y divide-slate-200">

          <tr *ngFor="let vuelo of vuelosFiltrados" class="hover:bg-slate-50">

            <td class="h-16 px-4 py-2 font-mono text-sm font-medium text-primary">
              {{ vuelo.vuelo_num }}
            </td>

            <td class="h-16 px-4 py-2 text-sm text-slate-600">
              {{ vuelo.origen }} → {{ vuelo.destino }}
            </td>

            <td class="h-16 px-4 py-2 text-sm text-slate-600">
              {{ vuelo.fecha }} {{ vuelo.hora }}
            </td>

            <td class="h-16 px-4 py-2 text-sm text-slate-600">
              {{ vuelo.avion_codigo }}
            </td>

            <td class="h-16 px-4 py-2 text-sm font-medium text-slate-800">
              {{ vuelo.piloto_codigo }}
            </td>

            <td class="h-16 px-4 py-2 text-sm">
              <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold"
                    [ngClass]="{
                      'bg-slate-100 text-slate-800': vuelo.estado === 'Programado',
                      'bg-yellow-100 text-yellow-800': vuelo.estado === 'Demorado' || vuelo.estado === 'Retrasado',
                      'bg-green-100 text-green-800': vuelo.estado === 'En Ruta' || vuelo.estado === 'A Tiempo',
                      'bg-red-100 text-red-800': vuelo.estado === 'Cancelado'
                    }">
                {{ vuelo.estado }}
              </span>
            </td>

            <td class="h-16 px-4 py-2 text-right">
              <div class="flex items-center justify-end gap-2">
                <button class="flex h-8 w-8 items-center justify-center rounded-lg text-slate-500 hover:bg-slate-200"
                        [routerLink]="['/dashboard/vuelos/editar', vuelo.vuelo_num]">
                  <svg xmlns="http://www.w3.org/2000/svg" class="size-5" fill="none"
                       viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M16.862 4.487l1.687 1.687M7.5 21h9.75M4.5 17.25v-3L14.25 4.5l3 3L7.5 17.25Z" />
                  </svg>
                </button>

                <button class="flex h-8 w-8 items-center justify-center rounded-lg text-red-600 hover:bg-red-100"
                        (click)="eliminarVuelo(vuelo)">
                  <svg xmlns="http://www.w3.org/2000/svg" class="size-5" fill="none"
                       viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M6 7h12m-9 0V4h6v3m-7 4v6m4-6v6M4 7h16l-1.5 12a2 2 0 0 1-2 2H7.5a2 2 0 0 1-2-2L4 7Z" />
                  </svg>
                </button>
              </div>
            </td>

          </tr>

          </tbody>
        </table>

      </div>

    </div>

  </div>
</div>
